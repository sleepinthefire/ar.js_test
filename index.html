<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, WebVR! • A-Frame</title>
    <meta name="description" content="Hello, WebVR! • A-Frame">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
      function getRandomInt(max) {
        return Math.floor(Math.random() * max);
      }
      AFRAME.registerComponent('markerhandler', {
        schema: {
          arobject: {type: 'string'}
        },
        init: function () {
          var sceneEl = document.querySelector('a-scene');
          this.objectList = sceneEl.querySelectorAll(this.data.arobject); 
          this.visibleObject;
          //マーカー検出/ロストの状態を管理する変数を定義しfalseで初期化
          //markerFoundはマーカー検出時に呼ばれる
          this.el.sceneEl.addEventListener('markerFound', () => {
            var index=getRandomInt(3);
            console.log(index);
            this.visibleObject=this.objectList[index];
            this.visibleObject.setAttribute('visible','true');
          });
          //markerLostはロスト検出時に呼ばれる
          this.el.sceneEl.addEventListener('markerLost', () => {
            this.visibleObject.setAttribute('visible','false');
          });         　
        },
        tick: function (time, timeDelta) {
          
        }
      });
    </script>
  </head>
  <body>
    <a-scene embedded arjs>
      <a-marker markerhandler="arobject:.randomObj"  preset="hiro">
        <a-sphere class="randomObj" position="0 1.25 0" radius="1.25" src="https://cdn.glitch.com/65aeb152-eaae-4cfb-8caf-6eeb287f6437%2Fearth.jpg?v=1615424610111" shadow
                  animation = "
                             property : rotation;
                             dur : 10000;
                             from : 0 0 0;
                             to : 0 360 0;
                             loop : -1;
                             easing : linear;
                             "    
                   visible="false" >
        </a-sphere>
        <a-box class="randomObj" position="0 0.625 0" scale="1.25 1.25 1.25" color="#00FFFF"  visible="false" shadow></a-box>
        <a-cylinder class="randomObj" position="0 0.75 0" radius="0.5" height="1.5" color="#FFC65D" visible="false" ></a-cylinder>
      </a-marker>
      
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>
